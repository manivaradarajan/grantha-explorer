import unittest
import os
import sys
import shutil

# Add project root to path to allow imports
script_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.dirname(script_dir)
sys.path.insert(0, project_root)

from tools.grantha_converter.md_to_json import convert_to_json

class TestMdToJsonConversion(unittest.TestCase):

    def setUp(self):
        self.test_dir = "temp_test_conversion"
        os.makedirs(self.test_dir, exist_ok=True)

    def tearDown(self):
        shutil.rmtree(self.test_dir)

    def _create_md_file(self, content):
        path = os.path.join(self.test_dir, "test.md")
        with open(path, 'w', encoding='utf-8') as f:
            f.write(content)
        return path

    def test_ref_order_is_preserved(self):
        """
        Tests that the order of refs in a real markdown file is preserved in the JSON output.
        This test uses the content of '08-02.converted.md' which was causing validation failures.
        """
        markdown_content = """---
grantha_id: brihadaranyaka-upanishad
canonical_title: बृहदारण्यकोपनिषत्
part_title: Adhyaya 8, Brahmana 2
text_type: upanishad
language: sanskrit
structure_levels:
- key: Adhyaya
  scriptNames:
    devanagari: अध्यायः
  children:
  - key: Brahmana
    scriptNames:
      devanagari: ब्राह्मणम्
    children:
    - key: Mantra
      scriptNames:
        devanagari: मन्त्रः
aliases: []
variants_available: []
metadata:
  source_file: granthas/vishvas-brh/08-02.converted.md
  processing_pipeline:
    processor: md_to_json.py
  quality_notes: Automatically generated from converted markdown.
  last_updated: '2025-11-11T05:33:46.221703+00:00'
---

# Mantra 8.2.4

<!-- sanskrit:devanagari -->

**बृहदारण्यकोपनिषत् अष्टमोऽध्यायः Part 2 \[अभिमर्शनमन्त्राः\] अथैनमभिमृशति, भ्रमदसि ज्वलदसि पूर्णमसि प्रस्तभ्धमस्येकसभमसि हिङ् कृतमसि हिङ् क्रियमाणमसि उद्गीथमसि उद्गीयमानमसि श्रावितमसि प्रत्याश्रावितमसि आद्रे संदीप्तमसि विभूरसि प्रभूरस्थानमसि ज्योतिरसि निधनमसि संवर्गोऽसीति ॥ ४ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.5

<!-- sanskrit:devanagari -->

**अथैनमुद्यच्छति, आमँस्यामँहितेमहि स हि राजेशानोऽधिपतिः स मां राजेशानोऽधिपतिं करोत्विति ॥ ५ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.6

<!-- sanskrit:devanagari -->

**\[सावित्र्यादिना आचमनम्\] अथैनमाचामति, तत्सवितुर्वरेण्यम् । मधुवाता ऋतायते मधुक्षरन्ति सिन्धवः माध्वीर्नः सन्त्वोषधीः भूःस्वाहा । भर्गो देवस्य धीमहि, मधुनक्तमुतोषसो मधुमत् पाथिर्वं रजः मधु द्यौरस्तु नःपिता भुवः स्वाहा । धियो यो नः प्रचोदयात् । मधुमान्नो वनस्पतिर्मधुमाँ अस्तु सूर्यः माध्वीर्गावो भवन्तु नः, स्वः स्वाहेति । सर्वाञ्च सावित्रीमन्वाह सर्वाश्च मधुमतीः \[सर्वाश्च व्याहृतीः\] अहमेवेदँ सर्वं भूयासम्; भूर्भुवस्स्वः स्वाहेत्यन्तत आचम्य पाणी प्रक्षाल्य जघनेनाग्निं प्राक्छिराः संविशति ॥ ६ ॥ प्रातरादित्यमुपतिष्ठते, दिशामेकपुण्डरीकमस्यहं मनुष्याणामेकपुण्डरीकं भूयासमिति । यथेतमेत्य जघनेनाग्निमासीनो वँश जपति ॥ ६ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.7

<!-- sanskrit:devanagari -->

**तँ हैतमुद्दालक आरुणिर्वाजसनेयाय याज्ञवल्क्याय अन्तेवासिन उक्त्वोवाच - अपि य एनँ शुष्के स्थाणौ निषिञ्चेत्, जायेरच्छाखाः, प्ररोहेयुः पलाशानीति ॥ ७ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.8

<!-- sanskrit:devanagari -->

**एतमु हैव वाजसनेयो याज्ञवल्क्यो मधुकाय पैङ्ग्यायान्तेवासिन उक्त्वोवाच - अपि य एनँ शुष्के स्थाणौ निषेञ्चेत् जायेरञ्छाखाः प्ररोहेयुः पलाशानीति ॥ ८ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.9

<!-- sanskrit:devanagari -->

**एतमु हैव मधुकः पैङ्ग्यश्चूलाय भागवित्तयेऽन्तेवासिन उक्त्वोवाच अपि य एवँ शुष्के स्थाणौ निषिञ्चेत्, जायेरन् शाखाः, प्ररोहेयुः पलाशानीति ॥ ९ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.10

<!-- sanskrit:devanagari -->

**एतमु हैव चूलो भागवित्तिर्जानकस्य आयस्थूणायान्ते वासिन उक्त्वोवाच - अपि य एनँ शुष्के स्थाणौ निषिञ्चेत् जायेरन् शाखाः, प्ररोहेयुः पलाशानीति ॥ १० ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.11

<!-- sanskrit:devanagari -->

**एतमु हैव जानकिरायस्थूणः सत्यकामाय जाबालाय अन्तेवासिने उक्त्वोवाच - अपि य एनँ शुष्के स्थाणौ निषिञ्चेत् । जायेरञ्छाखाः, प्ररोहेयुः पलाशानीति ॥ ११ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.12

<!-- sanskrit:devanagari -->

**एतमु हैव सत्यकामो जाबालोऽन्तेवासिभ्य उक्त्वा उवाच अपि य एनँ शुष्के स्थाणौ निषिञ्चेत्, जायेरन् शाखाः प्ररोहेयुः पलाशानीति । तमेतं नापुत्राय वाऽनन्तेवासिने वा ब्रूयात् ॥ १२ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.2.13

<!-- sanskrit:devanagari -->

**\[मन्थप्रकृतिद्रव्यगणनम्\] चतुरौदुम्बरो भवति, औदुम्बरः स्रुव औदुम्बरः चमस औदुम्बर इध्म औदुम्बर्या वुपमन्थानौ । दशग्राम्याणि धान्यानि भवन्ति, व्रीहियवास्तिलमाषा अणुप्रियङ्गवो गोधूमाश्च मसूराश्च खल्वाश्च खलकुलाश्च । तान् पिष्ट्वा दधनि मधुनि घृत उपसिञ्चति । आज्यस्य जुहोति ॥ १३ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.1

<!-- sanskrit:devanagari -->

**॥ इति अष्टमाध्याये तृतीयब्राह्मण प्रकाशिका ॥ चतुर्थं ब्राह्मणम् - पुत्रमन्थकर्मब्राह्मणम् एषां भूतानां पृथिवी रसः, पृथिव्या आपोऽपामोषधय ओषधीनां पुष्पाणि, पुष्पाणां फलानि, फलानां पुरुषः, पुरुषस्य रेतः ॥१॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.2

<!-- sanskrit:devanagari -->

**स ह प्रजापतिरीक्षाञ्चक्रे हन्तास्मै प्रतिष्ठां कल्पयानीति । स स्त्रियँ ससृजे । ताँ सृष्ट्वाऽध उपास्त । तस्मात् स्त्रियमध उपासते । स एतं प्राञ्चं ग्रावाणमात्मन एव समुदपारयत् । तेनैनामभ्यसृजत् ॥ २ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.3

<!-- sanskrit:devanagari -->

**\[अधोपहासे वाजपेयदृष्टिः तत्फलं च\] तस्या वेदिरुपस्थो लोमानि बर्हिश्चर्माधिषवणे समिद्धो मध्यतःस्थौ मुष्कौ । स यावान् ह वै वाजपेयेन यजमानस्य लोको भवति, तावानस्य लोको भवति, य एवं विद्वानधोपहासं चरति; आसाँ स्त्रीणाँ सुकृतं वृङ्क्ते । अथ य इदमविद्वानधोपहासं चरति, अस्य स्त्रियः सुकृतं वृञ्जते ॥ ३ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.4

<!-- sanskrit:devanagari -->

**एतद्ध स्म वै तद् विद्वानुद्दालक आरुणिराह, एतद्ध स्म वै तद् विद्वान्नाको मौद्गल्य आह, एतद्ध स्म वै तद् विद्वान् कुमारहारित आह - बहवो मर्या ब्राह्मणायना निरिन्द्रिया विसुकृतो अस्माल्लोकात् प्रयन्ति, य इदमविद्वाँसोऽधोपहासं चरन्तीति । बहु वा इदँ सुप्तस्य वा जाग्रतो वा रेतः स्कन्दति ॥ ४ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.5

<!-- sanskrit:devanagari -->

**तदभिमृशेदनु वा मन्त्रयेत यन्मेऽद्य रेतः पृथिवीम् अस्कान्त्सीद्यदोषधीरप्यसरत् यदप इदमहं तद्रेत आददे पुनर्मामैत्विन्द्रियं पुनस्तेजः पुनर्भगः पुनरग्निर्धिष्ण्या यथास्थानं कल्पन्तामित्यनामिकाङ् गुष्ठाभ्यामादायान्तरेण स्तनौ वा भ्रुवौ वा निमृज्यात् ॥ ५ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.6

<!-- sanskrit:devanagari -->

**अथ यद्युदक आत्मानं परिपश्येत्, तदभिमन्त्रयेत, मयि तेज इन्द्रियं यशो द्रविणँ सुकृतम् इति । श्रीर्हवा एषा स्त्रीणाम्, यन्मलोद्वासाः । तस्मात् मलोद्वाससं यशस्विनीमभिक्रम्योपमन्त्रयेत ॥ ६ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.7

<!-- sanskrit:devanagari -->

**\[स्त्री वशीकरणार्थं जपादि\] सा चैदस्मै न दद्यात्, काममेनामवक्रीणीयात्, सा चैदस्मै नैव दद्यात्, काममेनां यष्ट्या वा पाणिना वोपहत्यातिक्रामेत, इन्द्रियेण ते यशसा यश आदद इति; अयशा एव भवति ॥७॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.8

<!-- sanskrit:devanagari -->

**सा चेदस्मै दद्यात् - इन्द्रियेण ते यशसा यश आदधामि इति; यशस्विनावेव भवतः ॥८॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.9

<!-- sanskrit:devanagari -->

**स यामिच्छेत्, कामयत मेति, तस्यामर्थं निष्ठाय मुखेन मुखेँ सन्धायोपस्थम् अस्या अभिमृश्य जपेत्, अङ्गादङ्गात् सम्भवसि हृदयादधि जायसे । स त्वमङ्गकषायोऽसि दिग्धविद्धामिव मादयेमाममूं मयीति ॥ ९ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.10

<!-- sanskrit:devanagari -->

**अथ यामिच्छेत् न गर्भं दधीतेति, तस्यामर्थं निष्ठाय मुखेन मुखँ सन्धायाभिप्राण्यापान्यात्, इन्द्रियेण ते रेतसा रेत आदद इति । अरेता एव भवति ॥ १० ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.11

<!-- sanskrit:devanagari -->

**अथ यामिच्छेत्, दधीतेति, तस्यामर्थं निष्ठाय मुखेन मुखँ सन्धायापान्याभि- प्राण्यात् इन्द्रियेण ते रेतसा रेत आदधामीति; गर्भिण्येव भवति ॥ ११ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.12

<!-- sanskrit:devanagari -->

**\[जारस्य हानिकल्पनायाभिचारिकम्\] अथ यस्य जायायै जारः स्यात् - तञ्चेद् द्विष्यात्, आमपात्रेऽग्निमुपसमाधाय प्रतिलोमँ शरबर्हिः स्तीर्त्वा तस्मिन्नेताः शरभृष्टीः प्रतिलोमाः सर्पिषाऽक्ता जुहुयात् - मम समिद्धेऽहौषीः, प्राणापानौ त आददे; असाविति । मम समिद्धेऽहौषीः, पुत्र- पशूँस्त आददे; असावितiति । मम समिद्धेऽहौषीः, इष्टासुकृते त आददे; असाविति । मम समिद्धेऽहौषीः आशापराकाशौ त आददेऽसाविति स वा एष निरिन्द्रियो विसुकृदस्माल्लोकात्प्रैति, यमेवं विद्वान् ब्राह्मणः शपति ॥ तस्मादेवँविच्छ्रोत्रियस्य दारेण नोपहासमिच्छेदुत ह्येवंवित् परो भवति ॥ १२ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.13

<!-- sanskrit:devanagari -->

**\[ऋतुकालनियमाः\]**

**अथ यस्य जायामार्तवं विन्देत्, त्र्यहं कँसेन पिबेदहतवासाः, नैनां वृषलो न वृषल्युपहन्यात्, त्रिरात्रान्त आप्लुत्य व्रीहिनवघातयेत् ॥ १३ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.14

<!-- sanskrit:devanagari -->

**\[सर्वोत्कृष्टपुत्रोत्पत्तये पण्डितदुहित्रुत्पत्तये च कर्तव्यम्\]**

**अथ य इच्छेत्पुत्रो मे शुक्लो जायेत वेदमनुब्रुवीत सर्वमायुरियादिति, क्षीरौदनं पाचयित्वा सर्पिष्मन्तम् अश्नीयाताम् । ईश्वरौ जनयितवै ॥ १४ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.15

<!-- sanskrit:devanagari -->

**अथ य इच्छेत् पुत्रो मे कपिलः पिङ्गलो जायेत द्वौ वेदावनुब्रवीत सर्वमायु- रियादिति; दध्योदनं पाचयित्वा सर्पिष्मन्तमश्नीयाताम् । ईश्वरौ जनयितवै ॥ १५ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.16

<!-- sanskrit:devanagari -->

**अथ य इच्छेत् पुत्रो मे श्यामो लोहिताक्षो जायेत त्रीन् वेदानुब्रुवीत सर्वमायुरियात् इति उदौदनं पाचयित्वा सर्पिष्मन्तमश्नीयाताम् ईश्वरौ जनयितवै ॥ १६ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.17

<!-- sanskrit:devanagari -->

**अथ य इच्छेत् दुहिता मे पण्डिता जायेत सर्वमायुरियादिति, तिलौदनं पाचयित्वा सर्पिष्मन्तं अश्नीयाताम् । ईश्वरौ जनयितवै ॥ १७ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.18

<!-- sanskrit:devanagari -->

**अथ य इच्छेत्पुत्रो मे पण्डितो विजिगीथः समितिङ्गमः शुश्रूषितां वाचं भाषिता जायते सर्वान् वेदाननुब्रवीत सर्वमायुरियादिति माँसौदनं पाचयित्वा । सर्पिष्मन्तमश्नीयाताम् - ईश्वरौ जनयितवै - औक्ष्णेन वार्षभेण वा ॥ १८ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.19

<!-- sanskrit:devanagari -->

**अथाभिप्रातरेव स्थालीपाकावृताज्यं चेष्टित्वा स्थालीपाकस्योपघातं जुहोति, अग्नये स्वाहानुमतये स्वाहा देवाय सवित्रे सत्यप्रसवाय स्वाहेति । हुत्वोद्धृत्य**

**प्राश्नाति । प्राश्येतरस्याः प्रयच्छति । प्रक्षाल्य पाणी उदपात्रं पूरयित्वा तेनैनां त्रिरभ्युक्षति उत्तिष्ठातो विश्वावसोऽन्यामिच्छ प्रपूर्व्यां सञ्जायां पत्या सहेति ॥ १९ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.20

<!-- sanskrit:devanagari -->

**अथैनामभिपद्यते, अमोऽहमस्मि सा त्वँ सा त्वमस्यमोहँसामाहमस्मि ऋक् त्वं द्यौरहं पृथिवीत्वम् तावेहि सँरभावहै, सह रेतो दधावहै पुँसे पुत्राय वित्तय इति ॥ २० ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.21

<!-- sanskrit:devanagari -->

**अथास्या ऊरू विहापयति, विजिहीथां द्यावापृथिवी इति । तस्यामर्थं निष्ठाय मुखेन मुखँ सन्धाय त्रिरेनामनुलोमामनुमार्ष्टि- विष्णुर्योनिं कल्पयतु त्वष्टा रूपाणि पिँशतु । आसिञ्चतु प्रजापतिर्धाता गर्भं दधातु ते ॥ गर्भं धेहि सिनीवाली गर्भं धेहि पृथुष्टुके । गर्भं ते अश्विनौ देवावाधत्तां पुष्करस्रजौ ॥ २१ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.22

<!-- sanskrit:devanagari -->

**हिरण्मयी अरणी याभ्यां निर्मन्थतामश्विनौ । तत्ते गर्भं हवामहे दशमे मासि सूतवे । यथाऽग्निगर्भा पृथिवी यथा द्यौरिन्द्रेण गर्भिणी । वायुर्दिशां यथा गर्भ एवं गर्भं दधामि ते असाविति ॥ २२ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.13

<!-- sanskrit:devanagari -->

**\[सुखप्रसवोपायः\]**

**सोष्यन्तीमद्भिरभ्युक्षति - यथा वायुः पुष्करिणीँ समिङ्गयति सर्वतः । एवा ते गर्भ एजतु सहावैतु जरायुणा ॥ इन्द्रस्यायं व्रजः कृतः सार्गलः सपरिश्रयः । तमिन्द्र निर्जहि गर्भण सावराँ सहेति ॥ १३ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.24

<!-- sanskrit:devanagari -->

**\[जातकर्मकथनम्\]**

**जातेऽग्निमुपसमाधाय, अङ्क आधाय कँसे पृषदाज्यँ संनीय पृषदाज्य- स्योपघातं जुहोति - अस्मिन् सहस्रं पुष्यासमेधमान; स्वे गृहे । अस्योपसद्यां माच्छेत्सीत् प्रजया च पशुभिश्च स्वाहा । मयि प्राणांस्त्वयि मनसा जुहोमि स्वाहा । यत् कर्मणाऽत्यरीरिचं यद्वा न्यूनमिहाकरम् । अग्निष्टत् स्विष्टकृद्विद्वान् स्विष्टं सुहुतं करोतु नः स्वाहेति ॥ २४ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.25

<!-- sanskrit:devanagari -->

**अथास्य दक्षिणं कर्णमभिनिधाय वाग्वागिति त्रिरथ दधि मधु घृतँ सन्नीयानन्तर्हितेन जातरूपेण प्राशयति, भूस्ते दधामि भुवस्ते दधामि स्वस्ते दधामि भूर्भुवःस्वः सर्वं त्वयि दधामीति ॥ २५ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.26

<!-- sanskrit:devanagari -->

**\[नामकरणम्\]**

**अथास्य नाम करोति, वेदोऽसीति । तदस्य तद्गुह्यमेव नाम भवति ॥ २६ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.27

<!-- sanskrit:devanagari -->

**\[स्तनप्रदानमन्त्रः\]**

**अथैनं मात्रे प्रदाय स्तनं प्रयच्छति- यस्ते स्तनः स (श) शयो यो मयोभूर्या रत्नधा वसुविद्यस्सुदत्रः । येन विश्वा पुष्यसि वार्याणि सरस्वति तमिह धातवेकरिति ॥ २७ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.4.28

<!-- sanskrit:devanagari -->

**\[मात्रभिमन्त्रणं सुपितापुत्रस्तुतिश्च\]**

**अथास्य मातरमभिमन्त्रयते- इलाऽसि मैत्रावरुणी वीरे वीरमजीजनत् । सा त्वं वीरवती भव याऽस्मान् वीरवतोऽकरदिति ॥ तं वा एतमाहुः अतिपिता सताभूरति पितामहो बताभूः परमां बत । काष्ठां प्रापच्छ्रिया यशसा प्रहावर्चसेन, य एवंविदो ब्राह्मणस्य पुत्रो जायत इति ॥ २८ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.5.1

<!-- sanskrit:devanagari -->

**॥ अष्टमाध्याये चतुर्थब्राह्मण प्रकाशिका ॥ पञ्चमं ब्राह्मणं - वंशब्राह्मणम् अथ वँशः । पौतिमाषीपुत्रः कात्यायनीपुत्रात्, कात्यायनीपुत्रो गौतमीपुत्रात्, गौतमीपुत्रो भारद्वाजीपुत्रात्, भारद्वाजीपुत्रः पाराशरीपुत्रात्, पाराशरीपुत्रः औपस्वस्तीपुत्रात्, औपस्वस्तीपुत्रः पाराशरीपुत्रात्, पाराशरीपुत्रः कात्ययनीपुत्रात्, कात्यायनीपुत्रः कौशिकीपुत्रात्, कौशिकीपुत्र आलम्बीपुत्राच्च वैयाघ्रपदीपुत्रच्च, वैयाघ्रपदीपुत्रः काण्वीपुत्राच्च कापीपुत्रच्च, कापीपुत्रः ॥१॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.5.2

<!-- sanskrit:devanagari -->

**आत्रेयीपुत्रात्, आत्रेयीपुत्रो, गौतमीपुत्रात्, गौतमीपुत्रो भारद्वाजीपुत्रात्, भारद्वाजीपुत्रः पाराशरीपुत्रात्, पाराशरीपुत्रो वात्सीपुत्रात्, वात्सीपुत्रः पाराशरीपुत्रात्, पाराशरीपुत्रो वार्कारुणीपुत्रात्, वार्कारुणीपुत्रो वार्कारुणीपुत्रात्, वार्कारुणीपुत्रः आर्तभागीपुत्रात्, आर्तभागीपुत्रः शौङ्गीपुत्रात्, शौङ्गीपुत्रः सांकृतीपुत्रात्, सांकृतीपुत्र आलम्बायनीपुत्रात्, आलम्बायनीपुत्र आलम्बीपुत्रात्, आलम्बीपुत्रो जायन्तीपुत्रात्, जायन्तीपुत्रो माण्डूकायनीपुत्रात्, माण्डूकायनीपुत्रो माण्डूकीपुत्रात्, माण्डूकीपुत्रः शाण्डिलीपुत्रात्, शाण्डिलीपुत्रो राथीतरीपुत्रात्, राथीतरीपुत्रो भालुकीपुत्रात्, भालुकीपुत्रः क्रौञ्चिकीपुत्राभ्याम्, क्रौञ्चिकीपुत्रौ वैदृभदीपुत्रात्, वैदृभतीपुत्रः कार्शकेयीपुत्रात् कार्शकेयीपुत्रः प्राचीनयोगीपुत्रात्, प्राचीनयोगीपुत्रः साञ्जीवीपुत्रात्, साञ्जीवीपुत्रः प्राश्नी पुत्रादासुरिवासिनः, प्राश्नीपुत्र आसुरायणात्, आसुरायण आसुरेः, आसुरिः ॥ २ ॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.5.3

<!-- sanskrit:devanagari -->

**याज्ञवल्क्यात् याज्ञवल्क्य उद्दालकात्, उद्दालकोऽरुणात्, अरुण उपवेशेः, उपवेशिः कुश्रेः, कुश्रिर्वाजश्रवसो वाजश्रवा जिह्वावतो जिह्वावान् वाध्योगात्, वाध्योगोऽसिताद्वार्षगणात्, असितो वार्षगणो हरितात् कश्यपात्, हरितः कश्यपः शिल्पात् कश्यपात्, शिल्पः कश्यपः कश्यपान्नैर्ध्रुवेः, कश्यपो नैध्रुविर्वाचो वाक् अम्भिण्याः, अम्भिण्यादित्यात् । आदित्यानीमानि शुक्लानि यजूँषि वाजसनेयेन याज्ञवल्क्येनाऽऽख्यायन्ते ॥३॥**

<!-- /sanskrit:devanagari -->

# Mantra 8.5.4

<!-- sanskrit:devanagari -->

**समानमा साञ्जीवीपुत्रात्, साञ्जीवीपुत्रो माण्डूकायनेः, माण्डूकायनिर्माण्डव्यात्, माण्डव्यः कौत्सात्, कौत्सो माहित्थेः, माहित्थिर्वामकक्षायणात्, वामकक्षायणः शाण्डिल्यात्, शाण्डिल्यो वात्स्यात्, वात्स्यः कुश्रेः, कुश्चिर्यज्ञवचसो राजस्तम्बायनात्, यज्ञवचा राजस्तम्बायनस्तुरात् कावषेयात्, तुरः कावषेयः प्रजापतेः, प्रजापतिर्ब्रह्मणः । ग्राहा स्वयम्भु । ग्रहाणे नमः ॥ ४ ॥**

<!-- /sanskrit:devanagari -->
"""
        
        json_data = convert_to_json(markdown_content)
        
        refs = [p['ref'] for p in json_data.get('passages', [])]
        
        expected_refs = [
            "8.2.4", "8.2.5", "8.2.6", "8.2.7", "8.2.8", "8.2.9", "8.2.10", 
            "8.2.11", "8.2.12", "8.2.13", "8.4.1", "8.4.2", "8.4.3", "8.4.4", 
            "8.4.5", "8.4.6", "8.4.7", "8.4.8", "8.4.9", "8.4.10", "8.4.11", 
            "8.4.12", "8.4.13", "8.4.14", "8.4.15", "8.4.16", "8.4.17", "8.4.18", 
            "8.4.19", "8.4.20", "8.4.21", "8.4.22", "8.4.13", "8.4.24", "8.4.25", 
            "8.4.26", "8.4.27", "8.4.28", "8.5.1", "8.5.2", "8.5.3", "8.5.4"
        ]

        self.assertEqual(refs, expected_refs, "The refs should be in the same order as the input file.")


if __name__ == '__main__':
    unittest.main()
